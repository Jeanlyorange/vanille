<template>
  <div class="arc-scheme-dashboard">
  <ul class="nav nav-tabs scheme-tabs" role="tablist">
    <li class="nav-item">
        <a class="nav-link active" href="#AddScheme" data-toggle="tab" id="add-tab" role="tab" aria-controls="Propose" aria-selected="false">Propose to Add Scheme</a>
    </li>
    <li class="nav-item">
        <a class="nav-link active" href="#ModifyScheme" data-toggle="tab" id="modify-tab" role="tab" aria-controls="Propose" aria-selected="false">Propose to Update Scheme</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#removeScheme" data-toggle="tab" id="remove-tab" role="tab" aria-controls="unPropose" aria-selected="false">Propose to Remove Scheme</a>
      </li>
  </ul>
    
  <div class="tab-content">

    <div class="tab-pane fade show active" id="AddScheme" role="tabpanel" aria-labelledby="add-tab">
         
      <instructions>Propose to add a scheme to <span class='org-name'>${orgName}</span>.
        After submitting the proposal, a vote will automatically be initiated using this scheme's voting machine.</instructions>
      
      <form>

        <form class="form-inline">
          <div class="form-group">
            <label for="schemeToAddAddress">Scheme Address</label>
            <input id="schemeToAddAddress" type="text" value.bind="schemeToAddAddress"/>
          </div>
            
          <div class="form-group">
            <a href="#" click.delegate="useAddress()">&lt;&lt;</a>
          </div>
          
          <div class="form-group">
            <arc-schemes-dropdown
              scheme.bind="currentSchemeSelection"
              dao-address.bind="orgAddress"
              exclude-registered="true"
              exclude-keys.bind="['GlobalConstraintRegistrar', 'UpgradeScheme']"
            >
              <!-- <span slot="noSchemes"><span class="org-name">${orgName}</span> already has all the schemes that are available from Arc.</span> -->
              <span slot="buttonText"><span class="font-weight-bold">${currentSchemeSelection ? currentSchemeSelection.name : 'From Current Schemes'}</span></span>
            </arc-schemes-dropdown>
          </div>
      </form>

        <div if.bind="!!currentSchemeSelection">
          <div class="scheme-config">
            <compose view-model="${'../schemeConfiguration/' + currentSchemeSelection.key}" model.bind="newSchemeConfiguration"></compose>
            <button class="btn-submit-proposal" click.delegate="addScheme()">Submit Proposal</button>
          </div>
        </div>
      </form>
    </div>  

    <div class="tab-pane fade show active" id="ModifyScheme" role="tabpanel" aria-labelledby="modify-tab">
         
      <instructions>Propose to update the parameters of a scheme in <span class='org-name'>${orgName}</span>.
        After submitting the proposal, a vote will automatically be initiated using this scheme's voting machine.</instructions>
      
      <form>
        <arc-schemes-dropdown
          scheme.bind="schemeToModify"
          dao-address.bind="orgAddress"
          exclude-unregistered.bind="true"
        >
        <!-- <span slot="noSchemes"><span class="org-name">${orgName}</span> already has all the schemes that are available from Arc.</span> -->
        <span slot="buttonText"><span class="font-weight-bold">${schemeToModify ? schemeToModify.name : 'Select Scheme'}</span></span>
      </arc-schemes-dropdown>
        
        <div if.bind="!!schemeToModify">
          <etherscanlink address=${schemeToModify.address}>${schemeToModify.address}</etherscanlink>
          <div class="scheme-config">
            <compose view-model="${'../schemeConfiguration/' + schemeToModify.key}" model.bind="modifiedSchemeConfiguration"></compose>
            <button class="btn-submit-proposal" click.delegate="modifyScheme()">Submit Proposal</button>
          </div>
        </div>
      </form>
    </div>  

    <div class="tab-pane fade" id="removeScheme" role="tabpanel" aria-labelledby="remove-tab">
      <instructions>Propose to remove a scheme from <span class='org-name'>${orgName}</span>.
        After submitting the proposal, a vote will automatically be initiated using this scheme's voting machine.</instructions>
      <form>
          <arc-schemes-dropdown
            scheme.bind="schemeToRemove"
            dao-address.bind="orgAddress"
            schemes.bind="allSchemes"
            exclude-unregistered.bind="true"
            >
            <span slot="noSchemes"><span class="org-name">${orgName}</span> has no schemes that can be removed.</span>
            <span slot="buttonText"><span class="font-weight-bold">${schemeToRemove ? schemeToRemove.name : 'Select Scheme to Remove'}</span></span>
          </arc-schemes-dropdown>

        <div if.bind="!!schemeToRemove">
            <etherscanlink address=${schemeToRemove.address}>${schemeToRemove.address}</etherscanlink>
            <div class="mt-3"><button class="btn-submit-proposal" click.delegate="removeScheme()">Submit Proposal</button></div>
        </div>
      </form>
    </div>
  </div>
</div>
</template>
