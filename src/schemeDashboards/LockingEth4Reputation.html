<template>
  <div class="arc-scheme-dashboard">
    <instructions>Lock ETH for a given period of time, release the ETH and redeem reputation.</instructions>
    <hr />
    <spinbutton onclick.call="refresh()" as-button="true" text="Refresh" spin.to-view="refreshing" title="Refresh"></spinbutton>
    <form with.bind="lockModel">

      <div class="card" style="margin-bottom: 2rem">
        <div class="card-body">
          <div class="card-title">Lock</div>
          <div if.to-view="lockingPeriodIsEnded">The locking period has ended, you can't lock</div>
          <div else class="row" style="width: 30rem;">
            <div class="col-6">
              <div class="form-group bmd-form-group">
                <label for="lockAmount">Eth to Lock</label>
                <input class="form-control" type='number' id="lockAmount" value.bind="amount | ethwei & updateTrigger:'blur'" />
              </div>
            </div>
            <div class="col-6">
              <div class="form-group bmd-form-group">
                <label for="lockingPeriod">Lock for How Long</label>
                <input class="form-control" id="lockingPeriod" value.bind="period  | secondsDays & updateTrigger:'blur'" />
                <span class="bmd-help">In days. Will be rounded down to the nearest second.</span>
              </div>
            </div>
            <button class="btn-submit-proposal" click.delegate="lock()">Submit New Lock</button>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-body">
          <div class="card-title">Release and Redeem</div>

          <div if.to-view="!lockingPeriodIsEnded && userScore">The locking period has not ended, you can't yet redeem</div>
          <div if.to-view="lockingPeriodIsEnded && (userScore === 0)">You have nothing to redeem</div>
          <button if.to-view="lockingPeriodIsEnded && userScore" class="btn-submit-proposal" click.delegate="redeem()">Redeem
            Reputation</button>

          <div if.bind="userScore">
            <locks-for-reputation locks.to-view="getLocks()" release.call="release({lock})" wrapper.one-time="wrapper"></locks-for-reputation>
          </div>
        </div>
      </div>
    </form>
  </div>
</template>
